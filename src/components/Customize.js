import {useState, useEffect} from 'react';
import { SketchPicker } from 'react-color';
import Checkbox from '@material-ui/core/Checkbox';
import Navbar from './Navbar'
import CheckBox from './CheckBox';
import {db, auth, storage} from '../utils/firebase';

function Customize() {
    
    //price
    const [price, setprice] = useState(300);
    const [user, setuser] = useState(null)

    
    useEffect(() => {
        auth.onAuthStateChanged((_user) => {
            if(_user) {
                console.log("user signed in");
                setuser(_user)
            }else {
                console.log("uh,oh")
            }
            
        })
        
    }, [])

    const OPTIONS = [
        {
            id: 'a',
            name : 'Bubblegum'
        },
        {
            id: 'b',
            name : 'Vanilla'
        },
        {
            id: 'c',
            name : 'Lavender'
        },
        {
            id: 'd',
            name : 'Lemon'
        },
    
    ]

    const addToCart = (price,title) => {
       

        // setaddActive(true)
        
        const newCartItem = {
            
            qty : 1,
            price: price,
            title : title,
            // imageUrl: imageUrl
        }

        // console.log(newCartItem)
        db.collection('cart').doc(`${user.email}`).collection('cartItems').add(newCartItem)
            .then((docRef) => {
            console.log("Document written")
        }).catch ((error) => {
            console.error(error)
        })
    }
    // handle checklist
    const [checkList, setcheckList] = useState([]);

    

    const [accent, setaccent] = useState('#D9B4EF');
    const [midaccent, setmidaccent] = useState('#40FDFD');
    const [lightaccent, setlightaccent] = useState('#FDCA40')
    const [pickacc, setpickacc] = useState(false);
    const [pickmidacc, setpickmidacc] = useState(false);
    const [picklighacc, setpicklighacc] = useState(false)

    const [checked, setChecked] = useState(false)


    const handleChange = (color) => {
        setaccent(color.hex)
    }

    const handleChangeMid = (color) => {
        console.log("mid")
        setmidaccent(color.hex)
    }

    const handleChangeLight = (color) => {
        setlightaccent(color.hex)
    }

    const handleCheckboxChange = (name,id) => {
        const existElement = checkList.find(e => e.id == id) ;
        const filteredElement = checkList.filter(e => e.id !== id);
        
        const insertedElement = !existElement ? [{name, id}, ...checkList] : filteredElement

        setcheckList(insertedElement);
        setprice(checkList.length * 100)
    };
    
    const onTap = () => {
        if(pickacc) setpickacc(!pickacc)
        if(pickmidacc) setpickmidacc(!pickmidacc)
        if(picklighacc) setpicklighacc(!picklighacc)

    }

   
    useEffect(() => {
        setprice(300 + checkList.length * 100)
        // console.log(checkList)
    }, [checkList])
       
    return (

        <div className="max-w-7xl m-auto" onClick={onTap}>
        <Navbar />
        <div className="flex flex-wrap justify-evenly relative">

            
            <div className="">

            {
                pickacc ? (<div>
                <SketchPicker className="absolute top-7 left-0" color={accent} onChangeComplete={handleChange}/>

            </div> ) : ""
            }

            {
                pickmidacc ? (<div>
                <SketchPicker className="absolute top-28 left-0" color={midaccent} onChangeComplete={handleChangeMid}/>

            </div> ) : ""
            }

            {
                picklighacc ? (<div>
                <SketchPicker className="absolute top-60 left-0" color={lightaccent} onChangeComplete={handleChangeLight}/>

            </div> ) : ""
            }

            
            <div className="">
            <h1 className="text-gray-500 my-3 font-medium">Customize the colors</h1>
                <div className="flex my-auto">
                
                    <button className="rounded-3xl px-6 mx-4 my-6 py-1 bg-lightaccent" onClick={() => setpickacc(!pickacc)}> Choose Primary Color</button>
                    <div style={{backgroundColor : accent}} className="w-10 h-10 my-6 rounded-3xl"> </div>

                </div>

                <div className="flex my-auto">
                    
                    <button className="rounded-3xl px-6 mx-4 my-6 py-1 bg-lightaccent" onClick={() => setpickmidacc(!pickmidacc)}> Choose Secondary Color</button>
                    <div style={{backgroundColor : midaccent}} className="w-10 h-10 my-6 rounded-3xl"> </div>

                </div>

                <div className="flex my-auto">
                    
                    <button className="rounded-3xl px-6 mx-4 my-6 py-1 bg-lightaccent" onClick={() => setpicklighacc(!picklighacc)}> Choose Tertiary Color</button>
                    <div style={{backgroundColor : lightaccent}} className="w-10 h-10 my-6 rounded-3xl"> </div>

                </div>

                <h1 className="text-gray-500 my-3 font-medium">Choose flavors</h1>
                <div className="flex shadow-md">
                    {OPTIONS.map(data => {
                        return  <CheckBox handleCheckboxChange={handleCheckboxChange} {...data} />
                    })
                }

               
                   
                </div>

                <div className="flex my-auto">
                    
                    <button className="rounded-3xl px-6 mx-4 my-6 py-1 bg-lightaccent" onClick={()=>addToCart(price, "Custom")}>Add to Cart</button>
                    <p className="mt-6">Price: Rs.{price}</p>
                

                </div>

            </div>

            </div>
            


            <div className="w-28">
                <svg width="500" height="500" viewBox="0 0 1023 1023" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M577.379 124.176C620.297 142.629 647.09 168.801 647.09 197.824C647.09 253.723 547.699 299.043 425.094 299.043C302.492 299.043 203.102 253.723 203.102 197.824C203.102 168.797 229.91 142.625 272.836 124.168C272.801 124.809 272.746 125.445 272.746 126.102C272.746 164.461 340.957 195.562 425.094 195.562C509.23 195.562 577.441 164.461 577.441 126.102C577.441 125.457 577.418 124.816 577.379 124.176Z" fill={accent}/>
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M273.062 130.512C274.25 139.148 278.887 147.352 286.371 154.844C296.898 167.363 315.18 177.402 337.719 183.004C362.457 190.918 392.586 195.562 425.094 195.562C464.188 195.562 499.828 188.848 526.801 177.812C527.789 181.719 528.305 185.707 528.305 189.77C528.305 236.219 461.461 273.883 379.008 273.883C296.559 273.883 229.715 236.219 229.715 189.77C229.715 166.648 246.277 145.711 273.062 130.512Z" fill={midaccent}/>
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M569.559 108.078C575.777 115.648 579.18 123.852 579.18 132.418C579.18 170.777 510.969 201.879 426.832 201.879C354.961 201.879 294.727 179.184 278.684 148.656C300.316 175.016 356.051 193.781 421.406 193.781C505.543 193.781 573.754 162.68 573.754 124.32C573.754 118.727 572.297 113.289 569.559 108.078Z" fill={lightaccent}/>
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M466.184 59.1875C530.359 67.3672 577.441 94.2266 577.441 126.102C577.441 164.461 509.23 195.562 425.094 195.562C340.957 195.562 272.746 164.461 272.746 126.102C272.746 54.8398 478.574 74.0742 395.785 4.63672C395.785 4.63672 457.25 4.64844 466.184 59.1875Z" fill={accent}/>
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M441.109 63.6289C486.477 69.4102 519.754 88.3906 519.754 110.926C519.754 138.039 471.539 160.023 412.066 160.023C352.594 160.023 304.379 138.039 304.379 110.926C304.379 68.6055 452.512 75.4297 410.406 19.7422C421.656 24.7383 445.035 43.3438 441.109 63.6289Z" fill={midaccent}/>
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M394.051 115C436.73 121.914 466.535 99.4961 465.887 57.5195C482.098 100.098 438.418 142.883 390.723 141.441C383.395 140.527 378.199 133.867 379.117 126.562C380.039 119.258 386.719 114.082 394.051 115Z" fill={accent}/>
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M264.535 135.453C265.094 139.516 266.414 143.473 268.434 147.316C246.914 161.891 233.957 180.625 233.957 201.074C233.957 224.438 250.867 245.574 278.172 260.82C243.469 245.414 221.188 221.527 221.188 194.711C221.188 171.594 237.75 150.656 264.535 135.453Z" fill="#FEFEFE"/>
                    <path fill-rule="evenodd" clip-rule="evenodd" d="M321.523 82.1914C306.668 96.2539 290.941 97.168 290.941 126.141C290.941 141.789 307.855 155.941 335.16 166.152C300.457 155.836 278.172 139.84 278.172 121.879C278.172 106.395 294.734 92.3711 321.523 82.1914Z" fill="#FEFEFE"/>
                    <path d="M582.82 814.391H265.387C230.324 814.391 201.898 785.953 201.898 750.879V441.672C201.898 425.605 204.328 409.648 209.121 394.309L249.516 322.176V242.789H598.691V322.176L639.609 395.121C644.051 409.918 646.305 425.289 646.305 440.738V750.879C646.305 785.953 617.879 814.391 582.82 814.391Z" fill={midaccent}/>
                    <path d="M582.82 830.266H265.387C221.629 830.266 186.027 794.652 186.027 750.879V441.672C186.027 423.953 188.695 406.41 193.965 389.562L195.266 386.562L233.641 318.035V226.91H614.562V318.016L654.812 390.547C659.699 406.836 662.176 423.73 662.176 440.723V750.879C662.176 794.652 626.578 830.266 582.82 830.266ZM223.801 400.582C219.801 413.902 217.77 427.703 217.77 441.672V750.879C217.77 777.141 239.133 798.512 265.387 798.512C265.387 798.512 376.488 766.754 424.102 766.754C471.719 766.754 582.82 798.512 582.82 798.512C609.07 798.512 630.434 777.141 630.434 750.879V440.738C630.434 427.398 628.563 414.141 624.879 401.328L582.82 326.336V258.668H265.387V326.32L223.801 400.582Z" fill={accent}/>
                    <path d="M646.305 290.422H201.898V222.879C201.898 207.57 214.312 195.156 229.609 195.156H618.578C633.895 195.156 646.305 207.57 646.305 222.895V290.422Z" fill="#F2B880"/>
                    <path d="M265.387 290.422H582.82V322.176H265.387V290.422Z" fill="#BBDEFB"/>
                    <path d="M715.559 494.582C698.914 486.758 682.027 479.645 664.945 473.223C509.766 414.957 338.547 414.957 183.363 473.223C166.281 479.645 149.398 486.758 132.746 494.582C157.828 506.273 181.637 519.316 204.074 533.535C196.723 559.043 191.063 584.562 187.082 609.91C200.625 603.547 214.367 597.758 228.262 592.535C354.516 545.133 493.805 545.133 620.047 592.535C633.945 597.758 647.68 603.547 661.23 609.91C657.246 584.562 651.594 559.043 644.23 533.535C666.668 519.316 690.484 506.273 715.559 494.582Z" fill="white"/>
                    <path d="M654.797 601.449L650.121 599.395C640.809 595.313 631.285 591.434 621.801 587.875C558.414 564.07 491.914 552.004 424.156 552.004C356.402 552.004 289.895 564.07 226.516 587.875C217.035 591.434 207.508 595.305 198.191 599.395L193.512 601.449L194.426 596.418C198.156 575.914 203.016 555.223 208.871 534.914L209.902 531.336L206.754 529.328C188.562 517.805 169.359 506.996 149.68 497.211L144.492 494.629L149.789 492.293C161.426 487.172 173.305 482.324 185.117 477.891C261.781 449.105 342.211 434.512 424.156 434.512C506.102 434.512 586.527 449.105 663.195 477.891C675.023 482.336 686.918 487.184 698.512 492.293L703.809 494.629L698.629 497.211C678.949 507 659.746 517.809 641.566 529.328L638.41 531.328L639.441 534.914C645.293 555.203 650.148 575.902 653.883 596.418L654.797 601.449ZM157.281 494.957C175.324 504.129 192.918 514.133 209.664 524.746L216.246 528.926L214.09 536.418C208.77 554.902 204.266 573.703 200.703 592.379C208.609 589.004 216.621 585.785 224.594 582.793C288.594 558.758 355.742 546.574 424.156 546.574C492.566 546.574 559.715 558.758 623.723 582.793C631.695 585.785 639.707 589.004 647.609 592.379C644.043 573.688 639.539 554.883 634.223 536.418L632.059 528.926L638.656 524.746C655.395 514.133 672.988 504.133 691.02 494.957C681.203 490.73 671.223 486.707 661.281 482.973C585.227 454.418 505.449 439.941 424.156 439.941C342.863 439.941 263.082 454.418 187.031 482.973C177.102 486.703 167.125 490.719 157.281 494.957Z" fill="white"/>
                    <path d="M264.281 529V483.5H277.125C281.083 483.5 284.583 484.375 287.625 486.125C290.667 487.875 293.01 490.365 294.656 493.594C296.323 496.823 297.167 500.531 297.188 504.719V507.625C297.188 511.917 296.354 515.677 294.688 518.906C293.042 522.135 290.677 524.615 287.594 526.344C284.531 528.073 280.958 528.958 276.875 529H264.281ZM270.281 488.438V524.094H276.594C281.219 524.094 284.812 522.656 287.375 519.781C289.958 516.906 291.25 512.812 291.25 507.5V504.844C291.25 499.677 290.031 495.667 287.594 492.812C285.177 489.938 281.74 488.479 277.281 488.438H270.281ZM341.281 507.719C341.281 512.177 340.531 516.073 339.031 519.406C337.531 522.719 335.406 525.25 332.656 527C329.906 528.75 326.698 529.625 323.031 529.625C319.448 529.625 316.271 528.75 313.5 527C310.729 525.229 308.573 522.719 307.031 519.469C305.51 516.198 304.729 512.417 304.688 508.125V504.844C304.688 500.469 305.448 496.604 306.969 493.25C308.49 489.896 310.635 487.333 313.406 485.562C316.198 483.771 319.385 482.875 322.969 482.875C326.615 482.875 329.823 483.76 332.594 485.531C335.385 487.281 337.531 489.833 339.031 493.188C340.531 496.521 341.281 500.406 341.281 504.844V507.719ZM335.312 504.781C335.312 499.385 334.229 495.25 332.062 492.375C329.896 489.479 326.865 488.031 322.969 488.031C319.177 488.031 316.188 489.479 314 492.375C311.833 495.25 310.719 499.25 310.656 504.375V507.719C310.656 512.948 311.75 517.062 313.938 520.062C316.146 523.042 319.177 524.531 323.031 524.531C326.906 524.531 329.906 523.125 332.031 520.312C334.156 517.479 335.25 513.427 335.312 508.156V504.781ZM363.688 508.719C358.542 507.24 354.792 505.427 352.438 503.281C350.104 501.115 348.938 498.448 348.938 495.281C348.938 491.698 350.365 488.74 353.219 486.406C356.094 484.052 359.823 482.875 364.406 482.875C367.531 482.875 370.312 483.479 372.75 484.688C375.208 485.896 377.104 487.562 378.438 489.688C379.792 491.812 380.469 494.135 380.469 496.656H374.438C374.438 493.906 373.562 491.75 371.812 490.188C370.062 488.604 367.594 487.812 364.406 487.812C361.448 487.812 359.135 488.469 357.469 489.781C355.823 491.073 355 492.875 355 495.188C355 497.042 355.781 498.615 357.344 499.906C358.927 501.177 361.604 502.344 365.375 503.406C369.167 504.469 372.125 505.646 374.25 506.938C376.396 508.208 377.979 509.698 379 511.406C380.042 513.115 380.562 515.125 380.562 517.438C380.562 521.125 379.125 524.083 376.25 526.312C373.375 528.521 369.531 529.625 364.719 529.625C361.594 529.625 358.677 529.031 355.969 527.844C353.26 526.635 351.167 524.99 349.688 522.906C348.229 520.823 347.5 518.458 347.5 515.812H353.531C353.531 518.562 354.542 520.74 356.562 522.344C358.604 523.927 361.323 524.719 364.719 524.719C367.885 524.719 370.312 524.073 372 522.781C373.688 521.49 374.531 519.729 374.531 517.5C374.531 515.271 373.75 513.552 372.188 512.344C370.625 511.115 367.792 509.906 363.688 508.719ZM417.562 508.719C412.417 507.24 408.667 505.427 406.312 503.281C403.979 501.115 402.812 498.448 402.812 495.281C402.812 491.698 404.24 488.74 407.094 486.406C409.969 484.052 413.698 482.875 418.281 482.875C421.406 482.875 424.188 483.479 426.625 484.688C429.083 485.896 430.979 487.562 432.312 489.688C433.667 491.812 434.344 494.135 434.344 496.656H428.312C428.312 493.906 427.438 491.75 425.688 490.188C423.938 488.604 421.469 487.812 418.281 487.812C415.323 487.812 413.01 488.469 411.344 489.781C409.698 491.073 408.875 492.875 408.875 495.188C408.875 497.042 409.656 498.615 411.219 499.906C412.802 501.177 415.479 502.344 419.25 503.406C423.042 504.469 426 505.646 428.125 506.938C430.271 508.208 431.854 509.698 432.875 511.406C433.917 513.115 434.438 515.125 434.438 517.438C434.438 521.125 433 524.083 430.125 526.312C427.25 528.521 423.406 529.625 418.594 529.625C415.469 529.625 412.552 529.031 409.844 527.844C407.135 526.635 405.042 524.99 403.562 522.906C402.104 520.823 401.375 518.458 401.375 515.812H407.406C407.406 518.562 408.417 520.74 410.438 522.344C412.479 523.927 415.198 524.719 418.594 524.719C421.76 524.719 424.188 524.073 425.875 522.781C427.562 521.49 428.406 519.729 428.406 517.5C428.406 515.271 427.625 513.552 426.062 512.344C424.5 511.115 421.667 509.906 417.562 508.719ZM448.594 529H442.594V483.5H448.594V529ZM473 508.719C467.854 507.24 464.104 505.427 461.75 503.281C459.417 501.115 458.25 498.448 458.25 495.281C458.25 491.698 459.677 488.74 462.531 486.406C465.406 484.052 469.135 482.875 473.719 482.875C476.844 482.875 479.625 483.479 482.062 484.688C484.521 485.896 486.417 487.562 487.75 489.688C489.104 491.812 489.781 494.135 489.781 496.656H483.75C483.75 493.906 482.875 491.75 481.125 490.188C479.375 488.604 476.906 487.812 473.719 487.812C470.76 487.812 468.448 488.469 466.781 489.781C465.135 491.073 464.312 492.875 464.312 495.188C464.312 497.042 465.094 498.615 466.656 499.906C468.24 501.177 470.917 502.344 474.688 503.406C478.479 504.469 481.438 505.646 483.562 506.938C485.708 508.208 487.292 509.698 488.312 511.406C489.354 513.115 489.875 515.125 489.875 517.438C489.875 521.125 488.438 524.083 485.562 526.312C482.688 528.521 478.844 529.625 474.031 529.625C470.906 529.625 467.99 529.031 465.281 527.844C462.573 526.635 460.479 524.99 459 522.906C457.542 520.823 456.812 518.458 456.812 515.812H462.844C462.844 518.562 463.854 520.74 465.875 522.344C467.917 523.927 470.635 524.719 474.031 524.719C477.198 524.719 479.625 524.073 481.312 522.781C483 521.49 483.844 519.729 483.844 517.5C483.844 515.271 483.062 513.552 481.5 512.344C479.938 511.115 477.104 509.906 473 508.719ZM529.031 488.438H514.406V529H508.438V488.438H493.844V483.5H529.031V488.438ZM558.406 517.125H539.344L535.062 529H528.875L546.25 483.5H551.5L568.906 529H562.75L558.406 517.125ZM541.156 512.188H556.625L548.875 490.906L541.156 512.188ZM588.438 508.719C583.292 507.24 579.542 505.427 577.188 503.281C574.854 501.115 573.688 498.448 573.688 495.281C573.688 491.698 575.115 488.74 577.969 486.406C580.844 484.052 584.573 482.875 589.156 482.875C592.281 482.875 595.062 483.479 597.5 484.688C599.958 485.896 601.854 487.562 603.188 489.688C604.542 491.812 605.219 494.135 605.219 496.656H599.188C599.188 493.906 598.312 491.75 596.562 490.188C594.812 488.604 592.344 487.812 589.156 487.812C586.198 487.812 583.885 488.469 582.219 489.781C580.573 491.073 579.75 492.875 579.75 495.188C579.75 497.042 580.531 498.615 582.094 499.906C583.677 501.177 586.354 502.344 590.125 503.406C593.917 504.469 596.875 505.646 599 506.938C601.146 508.208 602.729 509.698 603.75 511.406C604.792 513.115 605.312 515.125 605.312 517.438C605.312 521.125 603.875 524.083 601 526.312C598.125 528.521 594.281 529.625 589.469 529.625C586.344 529.625 583.427 529.031 580.719 527.844C578.01 526.635 575.917 524.99 574.438 522.906C572.979 520.823 572.25 518.458 572.25 515.812H578.281C578.281 518.562 579.292 520.74 581.312 522.344C583.354 523.927 586.073 524.719 589.469 524.719C592.635 524.719 595.062 524.073 596.75 522.781C598.438 521.49 599.281 519.729 599.281 517.5C599.281 515.271 598.5 513.552 596.938 512.344C595.375 511.115 592.542 509.906 588.438 508.719Z" fill="#F2B880"/>
                </svg>
            </div>




        </div>

        </div>
    )
}

export default Customize
